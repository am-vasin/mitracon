USE (base_path+"LIST_TIT") ORDER TAG LST_NUM

SELECT 0
USE (base_path+"LIST_DET") ORDER TAG BRON
SET RELATION TO VAL(ALLTRIM(LIST_NUM)) INTO LIST_TIT

SELECT 0
USE (base_path+"STOCK")

SCAN
  s = 0
  SELECT LIST_DET
  SEEK STOCK.CODE
  SCAN REST WHILE STOCK.CODE = CODE FOR EMPTY(LIST_TIT.SAL_NUM)
    s = s+QNT_REQ
  ENDSCAN
  SELECT STOCK
  delta = s-QNT_SAVE
  REPLACE QNT_SAVE WITH QNT_SAVE+delta, QNT WITH QNT-delta
ENDSCAN

CLOSE DATABASES
