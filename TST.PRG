NO = 0

N = ADIR(AAA, "BASE\*.DBF")
*ON ERROR DO ERR WITH ERROR(), MESSAGE()
FOR I = 1 TO N
  SELECT 0
  NM = "BASE\"+ALLTRIM(AAA(I, 1))
  SELECT 0
  USE (NM)
  NO = NO+1
ENDFOR

PROCEDURE ERR
PARAMETER EEE, MSS
ON ERROR
CLOSE DATA

WAIT WINDOW STR(EEE)+MSS
WAIT WINDOW STR(NO)
CANCEL
