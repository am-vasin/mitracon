*╔════════════════════════════════════════════════════════════════════════╗
*║   Имя файла Pos_Shab     Разработчик Андрей Васин                      ║
*╟────────────────────────────────────────────────────────────────────────╢
*║                                                                        ║
*║          Ввод шаблона для контекстного поиска в номенклатуре           ║
*║                                                                        ║
*╚══════════════════════════════════════════════════════════ 27.10.2005 ══╝
PROCEDURE Pos_Shab

*
*  Переменные состояния для навигации
*

PRIVATE stat_type     && Тип навигации: 0 - нестандартный;
                                        1 - бланк;
                                        2 - BROWSE - таблица;
                                        3 - BROWSE - список.
PRIVATE what_do       && Имя режима.
PRIVATE menu_name     && Имя асинхронного меню.
PRIVATE last_mouse    && Время последнего нажатия звериной кнопки.
PRIVATE win_name      && Имя окна ( окон для BROWSE ).
PRIVATE tmpSw

*
*   Заполняем значениями переменные состояния...
*
m.tmpSw = 1
m.stat_type  = 1
m.what_do    = ""
m.menu_name  = ""
m.last_mouse = 0
m.win_name   = PROGRAM()

*------------------------------------------------------------------------
*    Содержательная часть программы:
*

*┌─────────────────────────────────────────────┐
*│                                             │
*│ Шаблон для поиска ....:....!....:....!....: │
*│                                             │
*│  ( ) Поиск в названии                       │
*│  ( ) Поиск в названии и функц. назначении   │
*│  ( ) Поиск по артикулу                      │
*│                                             │
*│        < OK Ctrl-W > < Отказаться Esc >     │
*└─────────────────────────────────────────────┘

PRIVATE ex
m.ex = 1
*------------------------------------------------------------------------

PUSH KEY CLEAR       && На всякий пожарный случай!
DO Prp_Nav_2
DO D_Win_N WITH 11, 49, "Поиск позиции"

*------------------------------------------------------------------------
*      Ввод полей бланка
*

@ 3,  3 SAY "Шаблон для поиска" GET m.tmpShab
*@ 5,  5 GET m.tmpFunc FUNCTION "*C \Поиск по функциональному назначению"
@ 5,  4 GET m.tmpSw ;
FUNCTION "*RV Поиск в названии;Поиск в названии и функц. назначении;Поиск по артикулу"

@ WROWS()-2, FLOOR(WCOLS()/2-16) GET m.ex PICTURE "@*HT \! OK Ctrl-W ;\? Отказаться Esc "

READ CYCLE

IF m.ex # 1
  m.tmpShab = ""
ENDIF
*--------------------------------------------------------------------------
DO CASE
CASE m.tmpSw = 1
  m.tmpFunc = .F.
  m.tmpArt  = .F.
CASE m.tmpSw = 2
  m.tmpFunc = .T.
  m.tmpArt  = .F.
CASE m.tmpSw = 3
  m.tmpArt  = .T.
ENDCASE
POP KEY
RELEASE WINDOW (win_name)
RETURN
