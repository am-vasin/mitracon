*╔════════════════════════════════════════════════════════════════════════╗
*║   Имя файла Opt_Part     Разработчик Андрей Васин                      ║
*╟────────────────────────────────────────────────────────────────────────╢
*║                                                                        ║
*║                 Критерий приближения к оптовым ценам.                  ║
*║                                                                        ║
*╚══════════════════════════════════════════════════════════ 26.04.2001 ══╝
PROCEDURE Opt_Part

*
*  Переменные состояния для навигации
*

PRIVATE stat_type     && Тип навигации: 0 - нестандартный;
                                        1 - бланк;
                                        2 - BROWSE - таблица;
                                        3 - BROWSE - список.
PRIVATE what_do       && Имя режима.
PRIVATE menu_name     && Имя асинхронного меню.
PRIVATE last_mouse    && Время последнего нажатия звериной кнопки.
PRIVATE win_name      && Имя окна ( окон для BROWSE ).

*
*   Заполняем значениями переменные состояния...
*
stat_type  = 1
what_do    = ""
menu_name  = ""
last_mouse = 0
win_name   = PROGRAM()

*------------------------------------------------------------------------
*    Содержательная часть программы:
*

*  Критерий приближения к оптовым ценам
*┌────────────────────────────────────────┐
*│  Доля количества к норме упаковки 99%  │
*│                                        │
*│    < OK Ctrl-W > < Отказаться Esc >    │
*└────────────────────────────────────────┘

PRIVATE ex, tmp_opt
ex = 1
tmp_opt = Get_Sys("OPT_PART")
IF EMPTY(tmp_opt)
  tmp_opt = 80
ELSE
  tmp_opt = VAL(ALLTRIM(tmp_opt))*100
ENDIF
*------------------------------------------------------------------------

PUSH KEY CLEAR       && На всякий пожарный случай!
DO Prp_Nav_2
DO D_Win_N WITH 6, 44, "Критерий приближения к оптовым ценам"
@ 2, 4 SAY "Доля количества к норме упаковки   %"
*------------------------------------------------------------------------
*      Ввод полей бланка
*

@ 2, 37 GET tmp_opt PICTURE "99"
@ WROWS()-2, FLOOR(WCOLS()/2-16) GET ex PICTURE "@*HT \! OK Ctrl-W ;\? Отказаться Esc "

READ CYCLE

IF ex = 1
  *
  * Отрабатываем бланк
  tmp_opt = STR(tmp_opt/100, 4, 2)
  DO Put_Sys WITH "OPT_PART", tmp_opt
ENDIF
*--------------------------------------------------------------------------

POP KEY
RELEASE WINDOW (win_name)
RETURN
